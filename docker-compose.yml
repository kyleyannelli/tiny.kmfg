services:
  tiny-kmfg:
    build: .
    container_name: tiny-kmfg
    ports:
      - "30108:30108"  # API port
      - "30109:30109"  # Web management port
    volumes:
      - ./data:/app/data
      - ./certs:/app/certs
    environment:
      # Database configuration
      - KMFG_TINY_DB=/app/data/tiny.kmfg.db
      - KMFG_TINY_DB_LOG=false
      
      # Server ports (using defaults)
      - KMFG_TINY_API_PORT=30108
      - KMFG_TINY_WEB_PORT=30109
      
      # TLS configuration (using auto generated certs by default)
      #- KMFG_TINY_API_TLS=false # Uncomment to disable HTTPS for the API
      #- KMFG_TINY_WEB_TLS=false # Uncomment to disable HTTPS for the Web UI
      # Uncomment and modify if using custom certificates. These are auto generated by default.
      # - KMFG_TINY_CERT_FILE=/app/certs/cert.pem
      # - KMFG_TINY_KEY_FILE=/app/certs/key.pem
      
      # Uncomment if behind reverse proxy/tunnel
      # - KMFG_TINY_TRUSTED_IPS=172.18.0.1
    restart: unless-stopped
    networks:
      - tiny-kmfg-network

networks:
  tiny-kmfg-network:
    driver: bridge

volumes:
  tiny-kmfg-data:
    driver: local
